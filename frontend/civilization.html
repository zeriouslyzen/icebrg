<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICEBURG | AGI Civilization</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/civilization.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@300;400&display=swap"
        rel="stylesheet">
    <meta name="theme-color" content="#0a0a0f">
</head>

<body class="civilization-page">
    <!-- Background Grid -->
    <div class="civ-grid-bg"></div>

    <!-- Main Container -->
    <div class="civ-container">
        <!-- Header Bar -->
        <header class="civ-header">
            <div class="civ-header-left">
                <a href="/app" class="civ-back-btn" aria-label="Back to Chat">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                    </svg>
                </a>
                <h1 class="civ-title">AGI CIVILIZATION</h1>
                <span class="civ-status" id="civStatus">OFFLINE</span>
            </div>
            <div class="civ-header-center">
                <div class="civ-stat">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 6v6l4 2" />
                    </svg>
                    <span id="stepCounter">Step: 0</span>
                </div>
                <div class="civ-stat">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                    </svg>
                    <span id="agentCounter">Agents: 0</span>
                </div>
                <div class="civ-stat">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="12 2 2 7 12 12 22 7 12 2" />
                        <polyline points="2 17 12 22 22 17" />
                        <polyline points="2 12 12 17 22 12" />
                    </svg>
                    <span id="resourceCounter">Resources: 0</span>
                </div>
            </div>
            <div class="civ-header-right">
                <button class="civ-control-btn" id="startBtn" title="Start Simulation">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <polygon points="5 3 19 12 5 21 5 3" />
                    </svg>
                </button>
                <button class="civ-control-btn" id="pauseBtn" title="Pause" disabled>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="6" y="4" width="4" height="16" />
                        <rect x="14" y="4" width="4" height="16" />
                    </svg>
                </button>
                <button class="civ-control-btn" id="stepBtn" title="Step Forward">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5 4 15 12 5 20 5 4" fill="currentColor" />
                        <line x1="19" y1="5" x2="19" y2="19" />
                    </svg>
                </button>
                <select class="civ-speed-select" id="speedSelect">
                    <option value="1">1x Speed</option>
                    <option value="2">2x Speed</option>
                    <option value="5">5x Speed</option>
                    <option value="10">10x Speed</option>
                </select>
            </div>
        </header>

        <!-- Main Content -->
        <div class="civ-main">
            <!-- World Map Canvas -->
            <div class="civ-world-container">
                <canvas id="worldCanvas"></canvas>
                <div class="civ-world-overlay">
                    <div class="civ-zoom-controls">
                        <button class="civ-zoom-btn" id="zoomInBtn" title="Zoom In">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="11" cy="11" r="8" />
                                <line x1="21" y1="21" x2="16.65" y2="16.65" />
                                <line x1="11" y1="8" x2="11" y2="14" />
                                <line x1="8" y1="11" x2="14" y2="11" />
                            </svg>
                        </button>
                        <button class="civ-zoom-btn" id="zoomOutBtn" title="Zoom Out">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="11" cy="11" r="8" />
                                <line x1="21" y1="21" x2="16.65" y2="16.65" />
                                <line x1="8" y1="11" x2="14" y2="11" />
                            </svg>
                        </button>
                        <button class="civ-zoom-btn" id="resetViewBtn" title="Reset View">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" />
                                <path d="M21 3v5h-5" />
                                <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" />
                                <path d="M8 16H3v5" />
                            </svg>
                        </button>
                    </div>
                    <div class="civ-legend">
                        <div class="civ-legend-item">
                            <span class="civ-legend-dot agent"></span>
                            <span>Agent</span>
                        </div>
                        <div class="civ-legend-item">
                            <span class="civ-legend-dot resource-energy"></span>
                            <span>Energy</span>
                        </div>
                        <div class="civ-legend-item">
                            <span class="civ-legend-dot resource-knowledge"></span>
                            <span>Knowledge</span>
                        </div>
                        <div class="civ-legend-item">
                            <span class="civ-legend-dot resource-materials"></span>
                            <span>Materials</span>
                        </div>
                    </div>
                </div>
                <!-- Agent Tooltip -->
                <div class="civ-tooltip" id="agentTooltip" style="display: none;">
                    <div class="civ-tooltip-header">
                        <span class="civ-tooltip-name" id="tooltipName">Agent_0</span>
                        <span class="civ-tooltip-role" id="tooltipRole">RESEARCHER</span>
                    </div>
                    <div class="civ-tooltip-stats">
                        <div class="civ-tooltip-stat">
                            <span>Energy</span>
                            <div class="civ-tooltip-bar">
                                <div class="civ-tooltip-bar-fill energy" id="tooltipEnergy" style="width: 80%"></div>
                            </div>
                        </div>
                        <div class="civ-tooltip-stat">
                            <span>Mood</span>
                            <div class="civ-tooltip-bar">
                                <div class="civ-tooltip-bar-fill mood" id="tooltipMood" style="width: 60%"></div>
                            </div>
                        </div>
                        <div class="civ-tooltip-stat">
                            <span>Reputation</span>
                            <div class="civ-tooltip-bar">
                                <div class="civ-tooltip-bar-fill reputation" id="tooltipReputation" style="width: 70%">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="civ-tooltip-goal" id="tooltipGoal">Current: Exploring world</div>
                </div>
            </div>

            <!-- Right Sidebar -->
            <div class="civ-sidebar">
                <!-- Tab Navigation -->
                <div class="civ-tabs">
                    <button class="civ-tab active" data-tab="agents">Agents</button>
                    <button class="civ-tab" data-tab="economy">Economy</button>
                    <button class="civ-tab" data-tab="norms">Norms</button>
                    <button class="civ-tab" data-tab="events">Events</button>
                </div>

                <!-- Agents Tab -->
                <div class="civ-tab-content active" id="agentsTab">
                    <div class="civ-panel-header">
                        <h3>Agent Population</h3>
                        <button class="civ-add-btn" id="addAgentBtn" title="Add Agent">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19" />
                                <line x1="5" y1="12" x2="19" y2="12" />
                            </svg>
                        </button>
                    </div>
                    <div class="civ-agent-list" id="agentList">
                        <!-- Agents will be populated here -->
                        <div class="civ-empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" opacity="0.3">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                <circle cx="9" cy="7" r="4" />
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                            </svg>
                            <p>No agents yet</p>
                            <span>Start simulation to spawn agents</span>
                        </div>
                    </div>
                </div>

                <!-- Economy Tab -->
                <div class="civ-tab-content" id="economyTab">
                    <div class="civ-panel-header">
                        <h3>Resource Economy</h3>
                    </div>
                    <div class="civ-economy-stats">
                        <div class="civ-economy-card">
                            <div class="civ-economy-label">Total Trades</div>
                            <div class="civ-economy-value" id="totalTrades">0</div>
                        </div>
                        <div class="civ-economy-card">
                            <div class="civ-economy-label">Gini Coefficient</div>
                            <div class="civ-economy-value" id="giniCoeff">0.00</div>
                        </div>
                        <div class="civ-economy-card">
                            <div class="civ-economy-label">Total Volume</div>
                            <div class="civ-economy-value" id="totalVolume">0</div>
                        </div>
                    </div>
                    <h4>Market Prices</h4>
                    <div class="civ-price-list" id="priceList">
                        <!-- Prices will be populated here -->
                    </div>
                    <h4>Recent Trades</h4>
                    <div class="civ-trade-list" id="tradeList">
                        <!-- Trades will be populated here -->
                    </div>
                </div>

                <!-- Norms Tab -->
                <div class="civ-tab-content" id="normsTab">
                    <div class="civ-panel-header">
                        <h3>Social Norms</h3>
                    </div>
                    <div class="civ-norm-stats">
                        <div class="civ-norm-stat">
                            <span>Active Norms</span>
                            <span id="activeNorms">0</span>
                        </div>
                        <div class="civ-norm-stat">
                            <span>Violations</span>
                            <span id="totalViolations">0</span>
                        </div>
                        <div class="civ-norm-stat">
                            <span>Avg Adherence</span>
                            <span id="avgAdherence">0%</span>
                        </div>
                    </div>
                    <div class="civ-norm-list" id="normList">
                        <!-- Norms will be populated here -->
                    </div>
                </div>

                <!-- Events Tab -->
                <div class="civ-tab-content" id="eventsTab">
                    <div class="civ-panel-header">
                        <h3>Emergence Events</h3>
                    </div>
                    <div class="civ-event-list" id="eventList">
                        <!-- Events will be populated here -->
                        <div class="civ-empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" opacity="0.3">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
                            </svg>
                            <p>No emergence events</p>
                            <span>Events will appear as patterns emerge</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Status Bar -->
        <footer class="civ-footer">
            <div class="civ-footer-left">
                <span class="civ-footer-label">World:</span>
                <span id="worldSize">100x100</span>
            </div>
            <div class="civ-footer-center" id="statusMessage">
                Ready to initialize civilization
            </div>
            <div class="civ-footer-right">
                <span class="civ-footer-label">FPS:</span>
                <span id="fpsCounter">60</span>
            </div>
        </footer>
    </div>

    <!-- Add Agent Modal -->
    <div class="civ-modal" id="addAgentModal" style="display: none;">
        <div class="civ-modal-content">
            <div class="civ-modal-header">
                <h3>Add New Agent</h3>
                <button class="civ-modal-close" id="closeModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <div class="civ-modal-body">
                <div class="civ-form-group">
                    <label for="agentIdInput">Agent ID</label>
                    <input type="text" id="agentIdInput" placeholder="agent_custom_1">
                </div>
                <div class="civ-form-group">
                    <label for="agentRoleSelect">Role</label>
                    <select id="agentRoleSelect">
                        <option value="researcher">Researcher</option>
                        <option value="coordinator">Coordinator</option>
                        <option value="specialist">Specialist</option>
                        <option value="generalist">Generalist</option>
                        <option value="leader">Leader</option>
                        <option value="follower">Follower</option>
                    </select>
                </div>
            </div>
            <div class="civ-modal-footer">
                <button class="civ-btn secondary" id="cancelAddAgent">Cancel</button>
                <button class="civ-btn primary" id="confirmAddAgent">Add Agent</button>
            </div>
        </div>
    </div>

    <script src="/js/civilization.js"></script>
</body>

</html>